import{j as e,r as i}from"./ui-vendor-CLlWv0Ul.js";import{a as he,B as A,b as o,I as ue,S as Ge,c as Be,d as $e,e as Ue,f as k,T as ta,g as ra,h as us,i as Y,j as na,k as ee,D as vs,l as bs,m as ys,n as C,C as se,o as ae,p as te,q as re,u as ia,r as O,s as H,t as q,v as J,w as K,L as B,x as js,y as gs}from"./pages-C_-B4kC1.js";import{h as je,i as Oe,j as He,k as la,l as ca,m as oa,P as Cs,S as da,n as ma,L as xa,G as ha,o as ua,p as ja,C as ga,q as pa,B as P,r as Ss,g as Na,s as Ds,E as pe,e as qe,t as Je,H as Ne,K as fe,T as $,U as ge,M as fa,D as wa,v as ps,w as Ns,x as Te,y as Re,z as va,I as ba,J as fs,R as ya,N as Ca}from"./utils-vendor-Ba2y7g8A.js";import"./react-vendor-Ckhrjn13.js";import"./form-vendor-BSiPuYWr.js";const Fe={minLength:8,forbiddenPatterns:["123456","password","admin","gabinete","qwerty"]};class Sa{baseUrl="/api/credentials";validatePassword(a){const t=[];let n="weak";a.length<Fe.minLength&&t.push(`A senha deve ter pelo menos ${Fe.minLength} caracteres`),/[A-Z]/.test(a)||t.push("A senha deve conter pelo menos uma letra maiúscula"),/[a-z]/.test(a)||t.push("A senha deve conter pelo menos uma letra minúscula"),/\d/.test(a)||t.push("A senha deve conter pelo menos um número"),/[!@#$%^&*(),.?":{}|<>]/.test(a)||t.push("A senha deve conter pelo menos um caractere especial");const d=a.toLowerCase();for(const x of Fe.forbiddenPatterns)d.includes(x)&&t.push(`A senha não pode conter o padrão: ${x}`);if(t.length===0){let x=0;a.length>=12?x+=2:a.length>=10&&(x+=1),/[A-Z]/.test(a)&&(x+=1),/[a-z]/.test(a)&&(x+=1),/\d/.test(a)&&(x+=1),/[!@#$%^&*(),.?":{}|<>]/.test(a)&&(x+=1),/[^\w\s]/.test(a)&&(x+=1),x>=6?n="strong":x>=4&&(n="medium")}return{isValid:t.length===0,errors:t,strength:n}}async getCabinetCredentials(a){try{const t=await fetch(`${this.baseUrl}/${a}`);if(!t.ok){if(t.status===404)return null;throw new Error("Erro ao buscar credenciais")}return await t.json()}catch(t){throw console.error("Erro ao buscar credenciais:",t),t}}async updateCabinetCredentials(a,t,n){try{if(t.password){const h=this.validatePassword(t.password);if(!h.isValid)throw new Error(`Senha inválida: ${h.errors.join(", ")}`);if(t.password!==t.confirmPassword)throw new Error("As senhas não coincidem")}const d=await fetch(`${this.baseUrl}/${a}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({...t,confirmPassword:void 0})});if(!d.ok){const h=await d.json();throw new Error(h.message||"Erro ao atualizar credenciais")}const x=await d.json();return await this.logCredentialsAudit({cabinetId:a,action:t.password?"password_change":t.username?"username_change":"email_change",performedBy:n,oldValue:t.username?"username_anterior":t.email?"email_anterior":void 0,newValue:t.username||t.email||void 0}),x}catch(d){throw console.error("Erro ao atualizar credenciais:",d),d}}async logCredentialsAudit(a){try{await he.log({userId:a.performedBy,action:a.action==="username_change"?"username_change":a.action==="email_change"?"credentials_update":a.action==="password_change"?"password_change":"read",resourceType:"credentials",resourceId:a.cabinetId,details:`${a.action}: ${a.oldValue?`${a.oldValue} -> `:""}${a.newValue||"senha alterada"}`})}catch(t){console.error("Erro ao registrar auditoria de credenciais:",t)}}async getCredentialsAuditLogs(a){try{const t=a?`${this.baseUrl}/audit/${a}`:`${this.baseUrl}/audit`,n=await fetch(t);if(!n.ok)throw new Error("Erro ao buscar logs de auditoria");return await n.json()}catch(t){throw console.error("Erro ao buscar logs de auditoria:",t),t}}generateSecurePassword(a=12){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZ",n="abcdefghijklmnopqrstuvwxyz",d="0123456789",x="!@#$%^&*()_+-=[]{}|;:,.<>?";let h="";h+=t[Math.floor(Math.random()*t.length)],h+=n[Math.floor(Math.random()*n.length)],h+=d[Math.floor(Math.random()*d.length)],h+=x[Math.floor(Math.random()*x.length)];const g=t+n+d+x;for(let p=h.length;p<a;p++)h+=g[Math.floor(Math.random()*g.length)];return h.split("").sort(()=>Math.random()-.5).join("")}}const ws=new Sa,As=({status:c})=>{switch(c){case"ativo":return e.jsxs(A,{className:"bg-green-100 text-green-800 hover:bg-green-100",children:[e.jsx(He,{className:"h-3 w-3 mr-1"}),"Ativo"]});case"pendente":return e.jsxs(A,{className:"bg-yellow-100 text-yellow-800 hover:bg-yellow-100",children:[e.jsx(Oe,{className:"h-3 w-3 mr-1"}),"Pendente"]});case"inativo":return e.jsxs(A,{className:"bg-red-100 text-red-800 hover:bg-red-100",children:[e.jsx(je,{className:"h-3 w-3 mr-1"}),"Inativo"]});default:return e.jsx(A,{variant:"secondary",children:c})}},_e=({field:c,children:a,sortField:t,sortDirection:n,onSort:d})=>{const x=()=>t!==c?e.jsx(la,{className:"h-4 w-4 text-gray-400"}):n==="asc"?e.jsx(ca,{className:"h-4 w-4 text-blue-600"}):e.jsx(oa,{className:"h-4 w-4 text-blue-600"});return e.jsx(o,{variant:"ghost",className:"h-auto p-0 font-medium text-left justify-start hover:bg-transparent",onClick:()=>d(c),children:e.jsxs("span",{className:"flex items-center gap-2",children:[a,x()]})})},Da=({searchTerm:c,statusFilter:a,viewMode:t,tableDensity:n,onSearchChange:d,onStatusFilterChange:x,onViewModeChange:h,onTableDensityChange:g,onNewCabinet:p,canCreate:j=!1})=>e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Gerenciamento de Gabinetes"}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Gerencie gabinetes, credenciais e comunicações"})]}),j&&p&&e.jsxs(o,{onClick:p,className:"bg-blue-600 hover:bg-blue-700",children:[e.jsx(Cs,{className:"h-4 w-4 mr-2"}),"Novo Gabinete"]})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 items-start sm:items-center justify-between",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 flex-1",children:[e.jsxs("div",{className:"relative flex-1 max-w-md",children:[e.jsx(da,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-4 w-4"}),e.jsx(ue,{placeholder:"Buscar por nome, vereador, município...",value:c,onChange:N=>d(N.target.value),className:"pl-10"})]}),e.jsxs(Ge,{value:a,onValueChange:x,children:[e.jsxs(Be,{className:"w-48",children:[e.jsx(ma,{className:"h-4 w-4 mr-2"}),e.jsx($e,{placeholder:"Filtrar por status"})]}),e.jsxs(Ue,{children:[e.jsx(k,{value:"todos",children:"Todos os Status"}),e.jsx(k,{value:"ativo",children:"Ativo"}),e.jsx(k,{value:"pendente",children:"Pendente"}),e.jsx(k,{value:"inativo",children:"Inativo"})]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("div",{className:"flex items-center border rounded-lg p-1",children:[e.jsx(o,{variant:t==="table"?"default":"ghost",size:"sm",onClick:()=>h("table"),className:"h-8 px-3",children:e.jsx(xa,{className:"h-4 w-4"})}),e.jsx(o,{variant:t==="cards"?"default":"ghost",size:"sm",onClick:()=>h("cards"),className:"h-8 px-3",children:e.jsx(ha,{className:"h-4 w-4"})})]}),t==="table"&&e.jsxs(Ge,{value:n,onValueChange:N=>g(N),children:[e.jsx(Be,{className:"w-32",children:e.jsx($e,{})}),e.jsxs(Ue,{children:[e.jsx(k,{value:"compact",children:"Compacto"}),e.jsx(k,{value:"normal",children:"Normal"}),e.jsx(k,{value:"spacious",children:"Espaçoso"})]})]})]})]})]}),Aa=({currentPage:c,totalPages:a,itemsPerPage:t,totalItems:n,onPageChange:d,onItemsPerPageChange:x})=>{const h=(c-1)*t+1,g=Math.min(c*t,n),p=()=>{const N=[],l=[];for(let S=Math.max(2,c-2);S<=Math.min(a-1,c+2);S++)N.push(S);return c-2>2?l.push(1,"..."):l.push(1),l.push(...N),c+2<a-1?l.push("...",a):a>1&&l.push(a),l};return a<=1?null:e.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-between gap-4 mt-6",children:[e.jsxs("div",{className:"flex items-center gap-4 text-sm text-gray-600",children:[e.jsxs("span",{children:["Mostrando ",h," a ",g," de ",n," gabinetes"]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{children:"Itens por página:"}),e.jsxs(Ge,{value:t.toString(),onValueChange:x,children:[e.jsx(Be,{className:"w-20 h-8",children:e.jsx($e,{})}),e.jsxs(Ue,{children:[e.jsx(k,{value:"5",children:"5"}),e.jsx(k,{value:"10",children:"10"}),e.jsx(k,{value:"20",children:"20"}),e.jsx(k,{value:"50",children:"50"})]})]})]})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(o,{variant:"outline",size:"sm",onClick:()=>d(1),disabled:c===1,className:"h-8 w-8 p-0",children:e.jsx(ua,{className:"h-4 w-4"})}),e.jsx(o,{variant:"outline",size:"sm",onClick:()=>d(c-1),disabled:c===1,className:"h-8 w-8 p-0",children:e.jsx(ja,{className:"h-4 w-4"})}),p().map((j,N)=>{if(j==="...")return e.jsx("span",{className:"px-2 py-1 text-gray-400",children:"..."},`dots-${N}`);const l=j;return e.jsx(o,{variant:c===l?"default":"outline",size:"sm",onClick:()=>d(l),className:"h-8 w-8 p-0",children:l},l)}),e.jsx(o,{variant:"outline",size:"sm",onClick:()=>d(c+1),disabled:c===a,className:"h-8 w-8 p-0",children:e.jsx(ga,{className:"h-4 w-4"})}),e.jsx(o,{variant:"outline",size:"sm",onClick:()=>d(a),disabled:c===a,className:"h-8 w-8 p-0",children:e.jsx(pa,{className:"h-4 w-4"})})]})]})},ka=({cabinets:c,sortField:a,sortDirection:t,densityClasses:n,onSort:d,onView:x,onEdit:h,onDelete:g,onStatusChange:p,onShowAudit:j,onShowMessages:N,onManageCredentials:l,canEdit:S=!1,canDelete:T=!1,canManageCredentials:R=!1})=>c.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(P,{className:"h-12 w-12 mx-auto text-gray-300 mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Nenhum gabinete encontrado"}),e.jsx("p",{className:"text-gray-500",children:"Tente ajustar os filtros ou criar um novo gabinete."})]}):e.jsx("div",{className:"border rounded-lg overflow-hidden",children:e.jsxs(ta,{children:[e.jsx(ra,{children:e.jsxs(us,{children:[e.jsx(Y,{className:n,children:e.jsx(_e,{field:"name",sortField:a,sortDirection:t,onSort:d,children:"Gabinete"})}),e.jsx(Y,{className:n,children:"E-mail Login"}),e.jsx(Y,{className:n,children:e.jsx(_e,{field:"status",sortField:a,sortDirection:t,onSort:d,children:"Status"})}),e.jsx(Y,{className:n,children:e.jsx(_e,{field:"registrationDate",sortField:a,sortDirection:t,onSort:d,children:"Data de Cadastro"})}),e.jsx(Y,{className:`${n} w-20`,children:"Ações"})]})}),e.jsx(na,{children:c.map(u=>e.jsxs(us,{className:"hover:bg-gray-50",children:[e.jsx(ee,{className:n,children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("div",{className:"w-8 h-8 bg-blue-100 rounded-lg flex items-center justify-center",children:e.jsx(P,{className:"h-4 w-4 text-blue-600"})})}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("div",{className:"font-medium text-gray-900 truncate",children:u.name}),e.jsxs("div",{className:"text-sm text-gray-500 truncate",children:["Admin: ",u.adminName]})]})]})}),e.jsx(ee,{className:n,children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ss,{className:"h-4 w-4 text-blue-600"}),e.jsx("span",{className:"font-medium text-blue-600 truncate max-w-48",children:u.loginEmail||u.adminEmail})]})}),e.jsx(ee,{className:n,children:e.jsx(As,{status:u.status})}),e.jsx(ee,{className:n,children:e.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-500",children:[e.jsx(Na,{className:"h-4 w-4"}),e.jsx("span",{children:u.registrationDate.toLocaleDateString("pt-BR")})]})}),e.jsx(ee,{className:n,children:e.jsxs(vs,{children:[e.jsx(bs,{asChild:!0,children:e.jsx(o,{variant:"ghost",size:"sm",className:"h-8 w-8 p-0",children:e.jsx(Ds,{className:"h-4 w-4"})})}),e.jsxs(ys,{align:"end",className:"w-48",children:[e.jsxs(C,{onClick:()=>x(u),children:[e.jsx(pe,{className:"h-4 w-4 mr-2"}),"Visualizar"]}),S&&h&&e.jsxs(C,{onClick:()=>h(u),children:[e.jsx(qe,{className:"h-4 w-4 mr-2"}),"Editar"]}),N&&e.jsxs(C,{onClick:()=>N(u),children:[e.jsx(Je,{className:"h-4 w-4 mr-2"}),"Mensagens"]}),j&&e.jsxs(C,{onClick:()=>j(u),children:[e.jsx(Ne,{className:"h-4 w-4 mr-2"}),"Histórico"]}),R&&l&&e.jsxs(C,{onClick:()=>l(u),children:[e.jsx(fe,{className:"h-4 w-4 mr-2"}),"Credenciais"]}),e.jsx(C,{onClick:()=>p(u,"ativo"),children:"Marcar como Ativo"}),e.jsx(C,{onClick:()=>p(u,"pendente"),children:"Marcar como Pendente"}),e.jsx(C,{onClick:()=>p(u,"inativo"),children:"Marcar como Inativo"}),T&&e.jsxs(C,{onClick:()=>g(u.id),className:"text-red-600 focus:text-red-600",children:[e.jsx($,{className:"h-4 w-4 mr-2"}),"Excluir"]})]})]})})]},u.id))})]})}),Ma=({cabinets:c,onView:a,onEdit:t,onDelete:n,onStatusChange:d,onShowMessages:x,onShowCredentials:h,onShowHistory:g,canEdit:p=!1,canDelete:j=!1,canManageCredentials:N=!1})=>c.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(P,{className:"h-12 w-12 mx-auto text-gray-300 mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Nenhum gabinete encontrado"}),e.jsx("p",{className:"text-gray-500",children:"Tente ajustar os filtros ou criar um novo gabinete."})]}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:c.map(l=>e.jsxs(se,{className:"hover:shadow-lg transition-shadow min-h-[320px]",children:[e.jsx(ae,{className:"pb-4",children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{className:"flex items-start gap-3 min-w-0 flex-1",children:[e.jsx("div",{className:"w-12 h-12 bg-blue-100 rounded-lg flex items-center justify-center flex-shrink-0",children:e.jsx(P,{className:"h-6 w-6 text-blue-600"})}),e.jsx("div",{className:"min-w-0 flex-1",children:e.jsx(te,{className:"text-lg leading-tight break-words",children:l.name})})]}),e.jsx("div",{className:"flex-shrink-0",children:e.jsx(As,{status:l.status})})]})}),e.jsxs(re,{className:"space-y-4 flex-1 flex flex-col",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx(ge,{className:"h-4 w-4 text-gray-400 flex-shrink-0"}),e.jsx("span",{className:"break-words font-medium",children:l.councilMemberName})]}),e.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:[e.jsx(fa,{className:"h-4 w-4 text-gray-400 flex-shrink-0"}),e.jsx("span",{className:"break-words",children:l.municipality})]})]}),e.jsx("div",{className:"space-y-2 flex-1",children:l.adminEmail&&e.jsxs("div",{className:"flex items-start gap-2 text-sm text-gray-600",children:[e.jsx(Ss,{className:"h-4 w-4 text-gray-400 flex-shrink-0 mt-0.5"}),e.jsx("span",{className:"break-words",children:l.adminEmail})]})}),e.jsxs("div",{className:"text-xs text-gray-500 pt-2 border-t mt-auto",children:["Criado em ",new Date(l.createdAt).toLocaleDateString("pt-BR")]}),e.jsxs("div",{className:"flex flex-wrap gap-2 pt-3",children:[e.jsxs(o,{size:"sm",variant:"outline",onClick:()=>a(l),className:"flex-1 min-w-0",children:[e.jsx(pe,{className:"h-4 w-4 mr-1"}),"Ver"]}),x&&e.jsxs(o,{size:"sm",variant:"outline",onClick:()=>x(l),className:"flex-1 min-w-0",children:[e.jsx(Je,{className:"h-4 w-4 mr-1"}),"Msgs"]}),p&&t&&e.jsxs(o,{size:"sm",variant:"outline",onClick:()=>t(l),className:"flex-1 min-w-0",children:[e.jsx(qe,{className:"h-4 w-4 mr-1"}),"Editar"]}),N&&h&&e.jsxs(o,{size:"sm",variant:"outline",onClick:()=>h(l),className:"flex-1 min-w-0",children:[e.jsx(fe,{className:"h-4 w-4 mr-1"}),"Creds"]}),g&&e.jsxs(o,{size:"sm",variant:"outline",onClick:()=>g(l),className:"flex-1 min-w-0",children:[e.jsx(Ne,{className:"h-4 w-4 mr-1"}),"Hist"]}),d&&e.jsxs(vs,{children:[e.jsx(bs,{asChild:!0,children:e.jsxs(o,{size:"sm",variant:"outline",className:"flex-1 min-w-0",children:[e.jsx(Ds,{className:"h-4 w-4 mr-1"}),"Status"]})}),e.jsxs(ys,{align:"end",children:[e.jsx(C,{onClick:()=>d(l,"ativo"),children:"Marcar como Ativo"}),e.jsx(C,{onClick:()=>d(l,"pendente"),children:"Marcar como Pendente"}),e.jsx(C,{onClick:()=>d(l,"inativo"),children:"Marcar como Inativo"})]})]}),j&&n&&e.jsxs(o,{size:"sm",variant:"destructive",onClick:()=>n(l),className:"flex-1 min-w-0",children:[e.jsx($,{className:"h-4 w-4 mr-1"}),"Del"]})]})]})]},l.id))}),Ea=({cabinets:c})=>{const[a,t]=i.useState(""),[n,d]=i.useState("todos"),[x,h]=i.useState("table"),[g,p]=i.useState("normal"),[j,N]=i.useState(null),[l,S]=i.useState("asc"),[T,R]=i.useState(1),[u,we]=i.useState(10),ve=w=>{j===w?S(l==="asc"?"desc":"asc"):(N(w),S("asc"))},W=i.useMemo(()=>{let w=c;return a&&(w=w.filter(y=>y.name.toLowerCase().includes(a.toLowerCase())||y.councilMemberName.toLowerCase().includes(a.toLowerCase())||y.municipality.toLowerCase().includes(a.toLowerCase())||y.adminName.toLowerCase().includes(a.toLowerCase())||y.adminEmail.toLowerCase().includes(a.toLowerCase()))),n!=="todos"&&(w=w.filter(y=>y.status===n)),j&&w.sort((y,V)=>{let b,E;switch(j){case"name":b=y.name.toLowerCase(),E=V.name.toLowerCase();break;case"status":b=y.status,E=V.status;break;case"registrationDate":b=new Date(y.registrationDate),E=new Date(V.registrationDate);break;default:return 0}return b<E?l==="asc"?-1:1:b>E?l==="asc"?1:-1:0}),w},[c,a,n,j,l]);i.useEffect(()=>{R(1)},[a,n,j,l]);const be=Math.ceil(W.length/u),ne=(T-1)*u,ye=ne+u,Ce=W.slice(ne,ye);return{searchTerm:a,statusFilter:n,viewMode:x,tableDensity:g,sortField:j,sortDirection:l,currentPage:T,itemsPerPage:u,filteredCabinets:W,currentCabinets:Ce,totalPages:be,setSearchTerm:t,setStatusFilter:d,setViewMode:h,setTableDensity:p,handleSort:ve,handlePageChange:w=>{R(w)},handleItemsPerPageChange:w=>{we(parseInt(w)),R(1)},getDensityClasses:()=>{switch(g){case"compact":return"py-1 px-2 text-sm";case"spacious":return"py-4 px-4";default:return"py-2 px-3"}}}},Pa=[{id:"1",name:"Gabinete do Vereador João Silva",councilMemberName:"João Silva",municipality:"São Paulo",city:"São Paulo",address:{street:"Rua das Flores, 123",number:"123",complement:"Sala 101",neighborhood:"Centro",zipCode:"01234-567"},institutionalEmail:"gabinete@joaosilva.gov.br",adminName:"Maria Santos",adminEmail:"admin@joaosilva.gov.br",loginEmail:"maria.santos@gabinete.joaosilva.gov.br",status:"ativo",registrationDate:new Date("2024-01-15"),createdAt:new Date("2024-01-15"),updatedAt:new Date("2024-01-15")},{id:"2",name:"Gabinete da Vereadora Ana Costa",councilMemberName:"Ana Costa",municipality:"Rio de Janeiro",city:"Rio de Janeiro",address:{street:"Avenida Atlântica, 456",number:"456",neighborhood:"Copacabana",zipCode:"22070-001"},institutionalEmail:"contato@anacosta.gov.br",adminName:"Carlos Oliveira",adminEmail:"carlos@anacosta.gov.br",loginEmail:"carlos.oliveira@gabinete.anacosta.gov.br",status:"pendente",registrationDate:new Date("2024-02-20"),createdAt:new Date("2024-02-20"),updatedAt:new Date("2024-02-20")},{id:"3",name:"Gabinete do Vereador Pedro Lima",councilMemberName:"Pedro Lima",municipality:"Belo Horizonte",city:"Belo Horizonte",address:{street:"Rua da Liberdade, 789",number:"789",neighborhood:"Savassi",zipCode:"30112-000"},institutionalEmail:"gabinete@pedrolima.gov.br",adminName:"Lucia Santos",adminEmail:"lucia@pedrolima.gov.br",loginEmail:"lucia.santos@gabinete.pedrolima.gov.br",status:"ativo",registrationDate:new Date("2024-03-10"),createdAt:new Date("2024-03-10"),updatedAt:new Date("2024-03-10")}],Ia=[{id:"1",cabinetId:"1",cabinetName:"Gabinete do Vereador João Silva",action:"status_change",oldValue:"pendente",newValue:"ativo",comment:"Documentação aprovada e gabinete ativado",userId:"admin1",userName:"Administrador Sistema",timestamp:new Date("2024-01-16T10:30:00")},{id:"2",cabinetId:"2",cabinetName:"Gabinete da Vereadora Ana Costa",action:"created",newValue:"pendente",comment:"Gabinete criado aguardando aprovação",userId:"admin1",userName:"Administrador Sistema",timestamp:new Date("2024-02-20T14:15:00")},{id:"3",cabinetId:"3",cabinetName:"Gabinete do Vereador Pedro Lima",action:"status_change",oldValue:"pendente",newValue:"ativo",comment:"Aprovação automática - documentos em ordem",userId:"admin2",userName:"Maria Administradora",timestamp:new Date("2024-03-11T09:45:00")}],Va=[{id:"1",cabinetId:"1",content:"Status alterado para ativo após aprovação da documentação.",attachments:[],userId:"admin1",userName:"Administrador Sistema",timestamp:new Date("2024-01-16T10:30:00"),isStatusRelated:!0,statusChange:{from:"pendente",to:"ativo"}},{id:"2",cabinetId:"2",content:"Documentos adicionais solicitados para aprovação.",attachments:[{id:"att1",name:"documentos_pendentes.pdf",type:"file",url:"/files/documentos_pendentes.pdf",size:2048576}],userId:"admin1",userName:"Administrador Sistema",timestamp:new Date("2024-02-21T14:15:00"),isStatusRelated:!1}],_a=()=>{const{user:c,canManageCredentials:a}=ia(),[t,n]=i.useState(Pa),{searchTerm:d,statusFilter:x,viewMode:h,tableDensity:g,sortField:p,sortDirection:j,currentPage:N,itemsPerPage:l,filteredCabinets:S,currentCabinets:T,totalPages:R,setSearchTerm:u,setStatusFilter:we,setViewMode:ve,setTableDensity:W,handleSort:be,handlePageChange:ne,handleItemsPerPageChange:ye,getDensityClasses:Ce}=Ea({cabinets:t}),[I,Ke]=i.useState(null),[We,w]=i.useState(!1),[y,V]=i.useState(!1),[b,E]=i.useState(null),[U,Se]=i.useState(""),[De,Ae]=i.useState(""),[ks,Ze]=i.useState(!1),[Z]=i.useState(null),[Xe,Ms]=i.useState(Ia),[Es,Qe]=i.useState(!1),[X,Ps]=i.useState(null),[Ye,es]=i.useState(Va),[ie,ss]=i.useState(""),[Q,ke]=i.useState([]),[Is,as]=i.useState(!1),[L,Me]=i.useState(null),[Vs]=i.useState({statusChanges:!0,newMessages:!0,emailNotifications:!1}),[Ls,Ee]=i.useState(!1),[le,ts]=i.useState(null),[Pe,Ie]=i.useState(""),[zs,ce]=i.useState(!1),[M,rs]=i.useState(null),[F,ns]=i.useState(null),[v,oe]=i.useState({}),[z,Ve]=i.useState(null),[Le,Ts]=i.useState(!1),[ze,Rs]=i.useState(!1),[is,de]=i.useState(!1),[ls,_]=i.useState(null),[me,Fs]=i.useState(null),[G,_s]=i.useState(null),Gs=s=>{switch(s){case"ativo":return e.jsx(A,{variant:"default",children:s});case"pendente":return e.jsx(A,{variant:"secondary",children:s});case"inativo":return e.jsx(A,{variant:"destructive",children:s});default:return e.jsx(A,{variant:"outline",children:s})}},cs=s=>{Ke(s),w(!0)},os=s=>{Ps(s),Qe(!0)},ds=async s=>{rs(s),de(!0),_("");try{const r={id:`cred_${s.id}`,cabinetId:s.id,username:s.adminEmail.split("@")[0],email:s.adminEmail,lastPasswordChange:new Date(Date.now()-2592e6),isActive:!0,createdAt:s.createdAt,updatedAt:s.updatedAt};ns(r),oe({username:r.username,email:r.email,password:"",confirmPassword:""}),ce(!0)}catch{_("Erro ao carregar credenciais")}finally{de(!1)}},Bs=()=>{Ts(!Le)},ms=(s,r)=>{if(oe(m=>({...m,[s]:r})),s==="password"&&r){const m=gs(r);Ve(m)}},xs=(s,r)=>{E(s),Se(r),V(!0)},$s=()=>{if(b&&U){const s=b.status;n(m=>m.map(f=>f.id===b.id?{...f,status:U,updatedAt:new Date}:f));const r={id:Date.now().toString(),cabinetId:b.id,cabinetName:b.name,action:"status_change",oldValue:s,newValue:U,comment:De||void 0,userId:"current_user",userName:"Usuário Atual",timestamp:new Date};if(Ms(m=>[r,...m]),Vs.statusChanges){const m={id:Date.now().toString()+"_msg",cabinetId:b.id,content:De||`Status alterado de ${s} para ${U}`,attachments:[],userId:"current_user",userName:"Usuário Atual",timestamp:new Date,isStatusRelated:!0,statusChange:{from:s,to:U}};es(f=>[m,...f])}V(!1),E(null),Se(""),Ae("")}},Us=()=>{Pe==="Deletar Gabinete"&&le&&(n(s=>s.filter(r=>r.id!==le.id)),Ee(!1),ts(null),Ie(""))},Os=()=>{Ee(!1),ts(null),Ie("")},Hs=()=>{if(X&&(ie.trim()||Q.length>0||L)){const s=[];Q.forEach((m,f)=>{s.push({id:`att_${Date.now()}_${f}`,name:m.name,type:"file",url:URL.createObjectURL(m),size:m.size})}),L&&s.push({id:`audio_${Date.now()}`,name:"audio_gravado.webm",type:"audio",url:URL.createObjectURL(L),size:L.size,duration:0});const r={id:Date.now().toString(),cabinetId:X.id,content:ie.trim(),attachments:s,userId:"current_user",userName:"Usuário Atual",timestamp:new Date,isStatusRelated:!1};es(m=>[r,...m]),ss(""),ke([]),Me(null)}},qs=s=>{const r=Array.from(s.target.files||[]);ke(m=>[...m,...r])},Js=s=>{ke(r=>r.filter((m,f)=>f!==s))},Ks=async()=>{try{return(await navigator.permissions.query({name:"microphone"})).state}catch{return"prompt"}},Ws=async()=>{if(!navigator.mediaDevices||!navigator.mediaDevices.getUserMedia){alert("Seu navegador não suporta gravação de áudio. Use um navegador mais recente.");return}if(await Ks()==="denied"){alert(`Acesso ao microfone foi negado. Para habilitar:

1. Clique no ícone de cadeado/microfone na barra de endereços
2. Selecione "Permitir" para microfone
3. Recarregue a página e tente novamente`);return}try{const r=await navigator.mediaDevices.getUserMedia({audio:!0}),m=new MediaRecorder(r),f=[];m.ondataavailable=D=>{f.push(D.data)},m.onstop=()=>{const D=new Blob(f,{type:"audio/webm"});Me(D),r.getTracks().forEach(aa=>aa.stop())},m.start(),as(!0),window.currentRecorder=m}catch(r){if(console.error("Erro ao iniciar gravação:",r),r instanceof DOMException)switch(r.name){case"NotAllowedError":alert("Permissão negada para acessar o microfone. Por favor, permita o acesso ao microfone nas configurações do navegador e tente novamente.");break;case"NotFoundError":alert("Nenhum microfone foi encontrado. Verifique se há um microfone conectado ao dispositivo.");break;case"NotReadableError":alert("O microfone está sendo usado por outro aplicativo. Feche outros aplicativos que possam estar usando o microfone.");break;case"OverconstrainedError":alert("As configurações de áudio solicitadas não são suportadas pelo seu dispositivo.");break;case"SecurityError":alert("Acesso ao microfone bloqueado por questões de segurança. Certifique-se de estar usando HTTPS.");break;default:alert(`Erro ao acessar o microfone: ${r.message}`)}else alert("Erro desconhecido ao acessar o microfone. Verifique as permissões e tente novamente.")}},Zs=()=>{const s=window.currentRecorder;s&&s.state==="recording"&&(s.stop(),as(!1))},hs=s=>{if(s===0)return"0 Bytes";const r=1024,m=["Bytes","KB","MB","GB"],f=Math.floor(Math.log(s)/Math.log(r));return parseFloat((s/Math.pow(r,f)).toFixed(2))+" "+m[f]},Xs=async()=>{if(!(!M||!c)){if(!v.username?.trim()){_("Nome de usuário é obrigatório");return}if(v.password&&!z?.isValid){_("A senha não atende aos critérios de segurança");return}if(v.password!==v.confirmPassword){_("As senhas não coincidem");return}de(!0),_(""),await he.log({userId:c.id,action:"credentials_change_attempt",resourceType:"cabinet",resourceId:M.id,details:JSON.stringify({cabinetName:M.name,changedFields:{username:v.username!==F?.username,password:!!v.password}})});try{await ws.updateCabinetCredentials(M.id,v,c.id),await he.log({userId:c.id,action:"credentials_change_success",resourceType:"cabinet",resourceId:M.id,details:JSON.stringify({cabinetName:M.name,changedFields:{username:v.username!==F?.username,password:!!v.password}})}),ce(!1),rs(null),ns(null),oe({username:"",password:"",confirmPassword:""}),Ve(null),alert("Credenciais atualizadas com sucesso!")}catch(s){const r=s instanceof Error?s.message:"Erro ao atualizar credenciais";await he.log({userId:c.id,action:"credentials_change_error",resourceType:"cabinet",resourceId:M.id,details:JSON.stringify({cabinetName:M.name,error:r,changedFields:{username:v.username!==F?.username,password:!!v.password}})}),_(r)}finally{de(!1)}}},Qs=()=>{const s=ws.generateSecurePassword();Fs(s),oe(m=>({...m,password:s,confirmPassword:s}));const r=gs(s);Ve({isValid:r.isValid,errors:r.errors,strength:r.strength}),_s(r.strength)},Ys=async()=>{if(me)try{await navigator.clipboard.writeText(me),alert("Senha copiada para a área de transferência!")}catch(s){console.error("Erro ao copiar senha:",s)}},ea=()=>{Rs(!ze)},sa=()=>{const s=[["Nome do Gabinete","Administrador","Email Admin","Status","Data Cadastro"],...S.map(D=>[D.name,D.adminName,D.adminEmail,D.status,D.registrationDate.toLocaleDateString("pt-BR")])].map(D=>D.join(",")).join(`
`),r=new Blob([s],{type:"text/csv;charset=utf-8;"}),m=document.createElement("a"),f=URL.createObjectURL(r);m.setAttribute("href",f),m.setAttribute("download",`gabinetes_${new Date().toISOString().split("T")[0]}.csv`),m.style.visibility="hidden",document.body.appendChild(m),m.click(),document.body.removeChild(m)},xe={total:t.length,ativos:t.filter(s=>s.status==="ativo").length,pendentes:t.filter(s=>s.status==="pendente").length,inativos:t.filter(s=>s.status==="inativo").length};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-3xl font-bold text-gray-900 flex items-center gap-2",children:[e.jsx(P,{className:"h-8 w-8 text-blue-600"}),"Gerenciar Cadastros de Gabinetes"]}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Visualize e gerencie todos os gabinetes cadastrados no sistema"})]}),e.jsx("div",{className:"flex gap-2",children:e.jsxs(o,{variant:"outline",onClick:sa,children:[e.jsx(wa,{className:"h-4 w-4 mr-2"}),"Exportar"]})})]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-4",children:[e.jsxs(se,{className:"border-l-4 border-l-blue-500",children:[e.jsxs(ae,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(te,{className:"text-sm font-medium text-gray-600",children:"Total de Gabinetes"}),e.jsx(P,{className:"h-5 w-5 text-blue-500"})]}),e.jsx(re,{children:e.jsx("div",{className:"text-3xl font-bold text-gray-900",children:xe.total})})]}),e.jsxs(se,{className:"border-l-4 border-l-green-500",children:[e.jsxs(ae,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(te,{className:"text-sm font-medium text-gray-600",children:"Gabinetes Ativos"}),e.jsx(He,{className:"h-5 w-5 text-green-500"})]}),e.jsx(re,{children:e.jsx("div",{className:"text-3xl font-bold text-gray-900",children:xe.ativos})})]}),e.jsxs(se,{className:"border-l-4 border-l-yellow-500",children:[e.jsxs(ae,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(te,{className:"text-sm font-medium text-gray-600",children:"Pendentes de Aprovação"}),e.jsx(Oe,{className:"h-5 w-5 text-yellow-500"})]}),e.jsx(re,{children:e.jsx("div",{className:"text-3xl font-bold text-gray-900",children:xe.pendentes})})]}),e.jsxs(se,{className:"border-l-4 border-l-red-500",children:[e.jsxs(ae,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(te,{className:"text-sm font-medium text-gray-600",children:"Gabinetes Inativos"}),e.jsx(je,{className:"h-5 w-5 text-red-500"})]}),e.jsx(re,{children:e.jsx("div",{className:"text-3xl font-bold text-gray-900",children:xe.inativos})})]})]}),e.jsx(Da,{searchTerm:d,statusFilter:x,viewMode:h,tableDensity:g,onSearchChange:u,onStatusFilterChange:we,onViewModeChange:ve,onTableDensityChange:W,canCreate:!1}),h==="table"?e.jsx(ka,{cabinets:T,sortField:p,sortDirection:j,density:g,densityClasses:Ce(),onSort:be,onView:cs,onEdit:()=>{},onDelete:()=>{},onStatusChange:xs,onShowMessages:os,onManageCredentials:ds,onShowHistory:()=>{},canManageCredentials:a?.()??!1}):e.jsx(Ma,{cabinets:T,onView:cs,onEdit:()=>{},onDelete:()=>{},onStatusChange:xs,onShowMessages:os,onShowCredentials:ds,onShowHistory:()=>{},canManageCredentials:a?.()??!1}),e.jsx(Aa,{currentPage:N,totalPages:R,totalItems:S.length,itemsPerPage:l,onPageChange:ne,onItemsPerPageChange:ye}),e.jsx(O,{open:We,onOpenChange:w,children:e.jsxs(H,{className:"max-w-4xl max-h-[80vh] overflow-y-auto",children:[e.jsxs(q,{children:[e.jsxs(J,{className:"flex items-center gap-2",children:[e.jsx(P,{className:"h-5 w-5 text-blue-600"}),"Detalhes do Gabinete"]}),e.jsx(K,{children:"Informações completas do gabinete selecionado"})]}),I&&e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 flex items-center gap-2",children:[e.jsx(P,{className:"h-5 w-5 text-blue-600"}),"Dados do Gabinete"]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-600",children:"Nome do Gabinete"}),e.jsx("p",{className:"text-gray-900",children:I.name})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-600",children:"E-mail Institucional"}),e.jsx("p",{className:"text-gray-900",children:I.institutionalEmail})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-600",children:"Status"}),e.jsx("div",{className:"mt-1",children:Gs(I.status)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-600",children:"Data de Cadastro"}),e.jsx("p",{className:"text-gray-900",children:I.registrationDate.toLocaleDateString("pt-BR")})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 flex items-center gap-2",children:[e.jsx(ge,{className:"h-5 w-5 text-blue-600"}),"Administrador"]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-600",children:"Nome"}),e.jsx("p",{className:"text-gray-900",children:I.adminName})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-600",children:"E-mail"}),e.jsx("p",{className:"text-gray-900",children:I.adminEmail})]})]})]})]})})]})}),e.jsx(O,{open:y,onOpenChange:V,children:e.jsxs(H,{className:"max-w-md",children:[e.jsxs(q,{children:[e.jsxs(J,{className:"flex items-center gap-2",children:[e.jsx(Je,{className:"h-5 w-5"}),"Alterar Status"]}),e.jsx(K,{children:b&&e.jsxs("span",{children:["Alterando status do gabinete ",e.jsx("strong",{children:b.name})," para ",e.jsx("strong",{children:U})]})})]}),e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{children:[e.jsx(B,{htmlFor:"comment",children:"Comentário/Observação"}),e.jsx(js,{id:"comment",placeholder:"Adicione um comentário sobre esta alteração de status...",value:De,onChange:s=>Ae(s.target.value),className:"mt-1",rows:3})]})}),e.jsxs("div",{className:"flex justify-end gap-2 pt-4",children:[e.jsx(o,{variant:"outline",onClick:()=>{V(!1),E(null),Se(""),Ae("")},children:"Cancelar"}),e.jsxs(o,{onClick:$s,className:"flex items-center gap-2",children:[e.jsx(ps,{className:"h-4 w-4"}),"Confirmar Alteração"]})]})]})}),e.jsx(O,{open:ks,onOpenChange:Ze,children:e.jsxs(H,{className:"max-w-4xl max-h-[80vh] overflow-y-auto",children:[e.jsxs(q,{children:[e.jsxs(J,{className:"flex items-center gap-2",children:[e.jsx(Ne,{className:"h-5 w-5"}),"Histórico de Alterações"]}),e.jsx(K,{children:Z&&e.jsxs("span",{children:["Histórico completo de alterações do gabinete ",e.jsx("strong",{children:Z.name})]})})]}),e.jsx("div",{className:"space-y-4",children:Z&&e.jsxs("div",{className:"space-y-3",children:[Xe.filter(s=>s.cabinetId===Z.id).map(s=>e.jsxs("div",{className:"border rounded-lg p-4 space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[s.action==="status_change"&&e.jsx(Oe,{className:"h-4 w-4 text-blue-500"}),s.action==="created"&&e.jsx(Cs,{className:"h-4 w-4 text-green-500"}),s.action==="updated"&&e.jsx(qe,{className:"h-4 w-4 text-yellow-500"}),s.action==="deleted"&&e.jsx($,{className:"h-4 w-4 text-red-500"}),e.jsxs("span",{className:"font-medium",children:[s.action==="status_change"&&"Alteração de Status",s.action==="created"&&"Criação",s.action==="updated"&&"Atualização",s.action==="deleted"&&"Exclusão"]})]}),e.jsx("span",{className:"text-sm text-gray-500",children:s.timestamp.toLocaleString("pt-BR")})]}),s.action==="status_change"&&e.jsxs("div",{className:"text-sm",children:[e.jsx("span",{className:"text-gray-600",children:"Status alterado de "}),e.jsx(A,{variant:"outline",className:"mx-1",children:s.oldValue}),e.jsx("span",{className:"text-gray-600",children:" para "}),e.jsx(A,{variant:"outline",className:"mx-1",children:s.newValue})]}),s.comment&&e.jsxs("div",{className:"bg-gray-50 p-3 rounded text-sm",children:[e.jsx("strong",{children:"Comentário:"})," ",s.comment]}),e.jsxs("div",{className:"flex items-center gap-1 text-xs text-gray-500",children:[e.jsx(ge,{className:"h-3 w-3"}),e.jsx("span",{children:s.userName})]})]},s.id)),Xe.filter(s=>s.cabinetId===Z.id).length===0&&e.jsxs("div",{className:"text-center py-8 text-gray-500",children:[e.jsx(Ne,{className:"h-12 w-12 mx-auto mb-4 opacity-50"}),e.jsx("p",{children:"Nenhum histórico encontrado para este gabinete."})]})]})}),e.jsx("div",{className:"flex justify-end pt-4",children:e.jsx(o,{variant:"outline",onClick:()=>Ze(!1),children:"Fechar"})})]})}),e.jsx(O,{open:Es,onOpenChange:Qe,children:e.jsxs(H,{className:"max-w-4xl max-h-[80vh] overflow-y-auto",children:[e.jsxs(q,{children:[e.jsxs(J,{className:"flex items-center gap-2",children:[e.jsx(Ns,{className:"h-5 w-5"}),"Mensagens - ",X?.name]}),e.jsx(K,{children:"Sistema de comunicação integrado com anexos e áudio"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"max-h-96 overflow-y-auto space-y-3 border rounded-lg p-4",children:[Ye.filter(s=>s.cabinetId===X?.id).map(s=>e.jsxs("div",{className:"border-b pb-3 last:border-b-0",children:[e.jsxs("div",{className:"flex items-start justify-between mb-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ge,{className:"h-4 w-4 text-gray-500"}),e.jsx("span",{className:"font-medium text-sm",children:s.userName}),s.isStatusRelated&&e.jsx(A,{variant:"secondary",className:"text-xs",children:"Mudança de Status"})]}),e.jsx("span",{className:"text-xs text-gray-500",children:s.timestamp.toLocaleString("pt-BR")})]}),s.content&&e.jsx("p",{className:"text-sm text-gray-700 mb-2",children:s.content}),s.statusChange&&e.jsxs("div",{className:"bg-blue-50 p-2 rounded text-xs",children:["Status: ",s.statusChange.from," → ",s.statusChange.to]}),s.attachments.length>0&&e.jsx("div",{className:"space-y-2 mt-2",children:s.attachments.map(r=>e.jsx("div",{className:"flex items-center gap-2 p-2 bg-gray-50 rounded",children:r.type==="audio"?e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Te,{className:"h-4 w-4 text-blue-500"}),e.jsx("span",{className:"text-sm",children:r.name}),e.jsx("audio",{controls:!0,className:"h-8",children:e.jsx("source",{src:r.url,type:"audio/webm"})})]}):e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Re,{className:"h-4 w-4 text-gray-500"}),e.jsx("span",{className:"text-sm",children:r.name}),e.jsxs("span",{className:"text-xs text-gray-500",children:["(",hs(r.size),")"]}),e.jsx(o,{variant:"ghost",size:"sm",asChild:!0,children:e.jsx("a",{href:r.url,download:r.name,children:"Download"})})]})},r.id))})]},s.id)),Ye.filter(s=>s.cabinetId===X?.id).length===0&&e.jsxs("div",{className:"text-center text-gray-500 py-8",children:[e.jsx(Ns,{className:"h-12 w-12 mx-auto mb-2 text-gray-300"}),e.jsx("p",{children:"Nenhuma mensagem encontrada"})]})]}),e.jsxs("div",{className:"space-y-3 border-t pt-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(B,{htmlFor:"message",children:"Nova Mensagem"}),e.jsx(js,{id:"message",placeholder:"Digite sua mensagem...",value:ie,onChange:s=>ss(s.target.value),rows:3})]}),Q.length>0&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(B,{children:"Anexos"}),e.jsx("div",{className:"space-y-1",children:Q.map((s,r)=>e.jsxs("div",{className:"flex items-center justify-between p-2 bg-gray-50 rounded",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Re,{className:"h-4 w-4 text-gray-500"}),e.jsx("span",{className:"text-sm",children:s.name}),e.jsxs("span",{className:"text-xs text-gray-500",children:["(",hs(s.size),")"]})]}),e.jsx(o,{variant:"ghost",size:"sm",onClick:()=>Js(r),children:e.jsx($,{className:"h-4 w-4"})})]},r))})]}),L&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(B,{children:"Áudio Gravado"}),e.jsxs("div",{className:"flex items-center gap-2 p-2 bg-gray-50 rounded",children:[e.jsx(Te,{className:"h-4 w-4 text-blue-500"}),e.jsx("span",{className:"text-sm",children:"audio_gravado.webm"}),e.jsx("audio",{controls:!0,className:"h-8",children:e.jsx("source",{src:URL.createObjectURL(L),type:"audio/webm"})}),e.jsx(o,{variant:"ghost",size:"sm",onClick:()=>Me(null),children:e.jsx($,{className:"h-4 w-4"})})]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(o,{variant:"outline",size:"sm",asChild:!0,children:e.jsxs("label",{className:"cursor-pointer",children:[e.jsx(Re,{className:"h-4 w-4 mr-1"}),"Anexar",e.jsx("input",{type:"file",multiple:!0,className:"hidden",onChange:qs,accept:".pdf,.doc,.docx,.jpg,.jpeg,.png,.txt"})]})}),Is?e.jsxs(o,{variant:"destructive",size:"sm",onClick:Zs,children:[e.jsx(va,{className:"h-4 w-4 mr-1"}),"Parar"]}):e.jsxs(o,{variant:"outline",size:"sm",onClick:Ws,disabled:!!L,children:[e.jsx(Te,{className:"h-4 w-4 mr-1"}),"Gravar"]})]}),e.jsxs(o,{onClick:Hs,disabled:!ie.trim()&&Q.length===0&&!L,children:[e.jsx(ps,{className:"h-4 w-4 mr-1"}),"Enviar"]})]})]})]})]})}),e.jsx(O,{open:Ls,onOpenChange:Ee,children:e.jsxs(H,{className:"max-w-md",children:[e.jsxs(q,{children:[e.jsxs(J,{className:"flex items-center gap-2 text-red-600",children:[e.jsx($,{className:"h-5 w-5"}),"Confirmar Exclusão"]}),e.jsx(K,{className:"text-gray-600",children:"Esta ação não pode ser desfeita. O gabinete será permanentemente removido do sistema."})]}),e.jsxs("div",{className:"space-y-4",children:[le&&e.jsx("div",{className:"p-4 bg-red-50 border border-red-200 rounded-lg",children:e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(P,{className:"h-4 w-4 text-red-600"}),e.jsx("span",{className:"font-medium text-red-800",children:le.name})]})}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(B,{htmlFor:"deleteConfirmation",className:"text-sm font-medium",children:["Para confirmar a exclusão, digite exatamente: ",e.jsx("span",{className:"font-bold text-red-600",children:"Deletar Gabinete"})]}),e.jsx(ue,{id:"deleteConfirmation",type:"text",value:Pe,onChange:s=>Ie(s.target.value),placeholder:"Digite: Deletar Gabinete",className:"border-red-300 focus:border-red-500 focus:ring-red-500"})]})]}),e.jsxs("div",{className:"flex justify-end gap-3 pt-4",children:[e.jsx(o,{variant:"outline",onClick:Os,children:"Cancelar"}),e.jsxs(o,{variant:"destructive",onClick:Us,disabled:Pe!=="Deletar Gabinete",className:"bg-red-600 hover:bg-red-700",children:[e.jsx($,{className:"h-4 w-4 mr-2"}),"Excluir Gabinete"]})]})]})}),e.jsx(O,{open:zs,onOpenChange:ce,children:e.jsxs(H,{className:"max-w-2xl",children:[e.jsxs(q,{children:[e.jsxs(J,{className:"flex items-center gap-2",children:[e.jsx(fe,{className:"h-5 w-5"}),"Gerenciar Credenciais do Gabinete"]}),e.jsx(K,{children:M&&e.jsxs("span",{children:["Alterar credenciais de acesso para: ",e.jsx("strong",{children:M.name})]})})]}),is?e.jsxs("div",{className:"flex items-center justify-center py-8",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"}),e.jsx("span",{className:"ml-2",children:"Carregando credenciais..."})]}):e.jsxs("div",{className:"space-y-6",children:[ls&&e.jsxs("div",{className:"p-4 bg-red-50 border border-red-200 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(je,{className:"h-4 w-4 text-red-600"}),e.jsx("span",{className:"text-red-800 font-medium",children:"Erro"})]}),e.jsx("p",{className:"text-red-700 text-sm mt-1",children:ls})]}),F&&e.jsxs("div",{className:"p-4 bg-blue-50 border border-blue-200 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[e.jsx(ba,{className:"h-4 w-4 text-blue-600"}),e.jsx("span",{className:"font-medium text-blue-800",children:"Credenciais Atuais"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Usuário:"}),e.jsx("p",{className:"font-medium",children:F.username})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Última alteração:"}),e.jsx("p",{className:"font-medium",children:F.lastPasswordChange?new Date(F.lastPasswordChange).toLocaleDateString("pt-BR"):"Nunca alterada"})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(B,{htmlFor:"newPassword",children:"Nova Senha"}),e.jsxs("div",{className:"relative",children:[e.jsx(ue,{id:"newPassword",type:Le?"text":"password",value:v.password,onChange:s=>ms("password",s.target.value),placeholder:"Digite a nova senha",className:z?.isValid===!1?"border-red-300":""}),e.jsx(o,{type:"button",variant:"ghost",size:"sm",className:"absolute right-0 top-0 h-full px-3 py-2 hover:bg-transparent",onClick:Bs,children:Le?e.jsx(fs,{className:"h-4 w-4 text-gray-400"}):e.jsx(pe,{className:"h-4 w-4 text-gray-400"})})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(B,{htmlFor:"confirmPassword",children:"Confirmar Nova Senha"}),e.jsxs("div",{className:"relative",children:[e.jsx(ue,{id:"confirmPassword",type:ze?"text":"password",value:v.confirmPassword,onChange:s=>ms("confirmPassword",s.target.value),placeholder:"Confirme a nova senha",className:z?.isValid===!1?"border-red-300":""}),e.jsx(o,{type:"button",variant:"ghost",size:"sm",className:"absolute right-0 top-0 h-full px-3 py-2 hover:bg-transparent",onClick:ea,children:ze?e.jsx(fs,{className:"h-4 w-4 text-gray-400"}):e.jsx(pe,{className:"h-4 w-4 text-gray-400"})})]})]}),G&&v.password&&e.jsx("div",{className:"mt-2",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"flex-1 bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:`h-2 rounded-full transition-all duration-300 ${G==="weak"?"w-1/3 bg-red-500":G==="medium"?"w-2/3 bg-yellow-500":"w-full bg-green-500"}`})}),e.jsx("span",{className:`text-sm font-medium ${G==="weak"?"text-red-600":G==="medium"?"text-yellow-600":"text-green-600"}`,children:G==="weak"?"Fraca":G==="medium"?"Média":"Forte"})]})})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(o,{type:"button",variant:"outline",size:"sm",onClick:Qs,className:"flex items-center gap-2",children:[e.jsx(ya,{className:"h-4 w-4"}),"Gerar Senha Segura"]}),me&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("code",{className:"px-2 py-1 bg-gray-100 rounded text-sm font-mono",children:me}),e.jsx(o,{type:"button",variant:"ghost",size:"sm",onClick:Ys,className:"flex items-center gap-1",children:e.jsx(Ca,{className:"h-3 w-3"})})]})]}),z?.errors&&z.errors.length>0&&e.jsxs("div",{className:"p-3 bg-red-50 border border-red-200 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(je,{className:"h-4 w-4 text-red-600"}),e.jsx("span",{className:"text-red-800 font-medium text-sm",children:"Requisitos da senha:"})]}),e.jsx("ul",{className:"text-red-700 text-sm space-y-1",children:z?.errors?.map((s,r)=>e.jsxs("li",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"w-1 h-1 bg-red-600 rounded-full"}),s]},r))})]}),z?.isValid&&v.password&&e.jsx("div",{className:"p-3 bg-green-50 border border-green-200 rounded-lg",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(He,{className:"h-4 w-4 text-green-600"}),e.jsx("span",{className:"text-green-800 font-medium text-sm",children:"Senha válida!"})]})})]})]}),e.jsxs("div",{className:"flex justify-end gap-3 pt-4",children:[e.jsx(o,{variant:"outline",onClick:()=>ce(!1),children:"Cancelar"}),e.jsxs(o,{onClick:Xs,disabled:!z?.isValid||is,className:"bg-blue-600 hover:bg-blue-700",children:[e.jsx(fe,{className:"h-4 w-4 mr-2"}),"Atualizar Credenciais"]})]})]})})]})};export{_a as default};
