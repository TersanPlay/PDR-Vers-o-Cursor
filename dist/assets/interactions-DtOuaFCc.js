import{r as u,j as e}from"./ui-vendor-CLlWv0Ul.js";import{C as _,o as O,p as B,q as z,I as L,S as T,c as S,d as C,e as I,f as t,T as Se,g as Ce,h as se,i as A,j as Ie,k as P,M as Ee,N as Ae,b as k,B as le,r as re,s as ne,t as ce,v as de,w as ie,L as p,O as Pe,G as Fe,P as b}from"./pages-C_-B4kC1.js";import{g as M,i as j,j as E,_ as D,n as Le,S as _e,t as U,E as Oe,e as Be,T as ze,M as W,a0 as oe,r as ke,f as Ue,U as Q,h as Y,F as V,a5 as ae,b as Ve,aa as Me,P as He}from"./utils-vendor-Ba2y7g8A.js";import"./react-vendor-Ckhrjn13.js";import"./form-vendor-BSiPuYWr.js";const Re=({interactions:m,onUpdateInteraction:n})=>{const d=u.useCallback(()=>{const i=new Date;m.forEach(l=>{if(l.status==="cancelado"||l.type!=="evento"||!l.scheduledDate)return;const h=new Date(l.scheduledDate);if(h.toDateString()===i.toDateString()&&l.eventStartTime&&l.eventEndTime){const[o,a]=l.eventStartTime.split(":").map(Number),[r,y]=l.eventEndTime.split(":").map(Number),g=new Date(i);g.setHours(o,a,0,0);const F=new Date(i);F.setHours(r,y,0,0);let f=l.status;if(i>=F&&l.status!=="concluido"?f="concluido":i>=g&&i<F&&l.status==="pendente"?f="em_progresso":i>=g&&i<F&&l.status==="em_progresso"&&(f="em_andamento"),f!==l.status){const G={...l,status:f,updatedAt:new Date};n(G)}}else if(h<i&&l.status==="pendente"){const o={...l,status:"em_progresso",updatedAt:new Date};n(o)}})},[m,n]);return u.useEffect(()=>{d();const i=setInterval(d,6e4);return()=>clearInterval(i)},[d]),{checkAndUpdateStatus:d}},qe=({total:m,pendentes:n,concluidas:d,atrasadas:i})=>{const l=m>0?Math.round(d/m*100):0;return e.jsxs("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-4",children:[e.jsxs(_,{className:"border-l-4 border-l-blue-500 shadow-sm",children:[e.jsxs(O,{className:"flex flex-row items-center justify-between space-y-0 pb-2 bg-blue-50",children:[e.jsx(B,{className:"text-sm font-medium text-gray-900",children:"Total"}),e.jsx(M,{className:"h-4 w-4 text-blue-500"})]}),e.jsxs(z,{children:[e.jsx("div",{className:"text-2xl font-bold text-gray-900",children:m}),e.jsx("p",{className:"text-xs text-gray-600",children:"Total de interações"})]})]}),e.jsxs(_,{className:"border-l-4 border-l-yellow-500 shadow-sm",children:[e.jsxs(O,{className:"flex flex-row items-center justify-between space-y-0 pb-2 bg-yellow-50",children:[e.jsx(B,{className:"text-sm font-medium text-gray-900",children:"Pendentes"}),e.jsx(j,{className:"h-4 w-4 text-yellow-500"})]}),e.jsxs(z,{children:[e.jsx("div",{className:"text-2xl font-bold text-gray-900",children:n}),e.jsx("p",{className:"text-xs text-gray-600",children:"Em aberto"})]})]}),e.jsxs(_,{className:"border-l-4 border-l-green-500 shadow-sm",children:[e.jsxs(O,{className:"flex flex-row items-center justify-between space-y-0 pb-2 bg-green-50",children:[e.jsx(B,{className:"text-sm font-medium text-gray-900",children:"Concluídas"}),e.jsx(E,{className:"h-4 w-4 text-green-500"})]}),e.jsxs(z,{children:[e.jsx("div",{className:"text-2xl font-bold text-gray-900",children:d}),e.jsxs("p",{className:"text-xs text-gray-600",children:[l,"% taxa de conclusão"]})]})]}),e.jsxs(_,{className:"border-l-4 border-l-red-500 shadow-sm",children:[e.jsxs(O,{className:"flex flex-row items-center justify-between space-y-0 pb-2 bg-red-50",children:[e.jsx(B,{className:"text-sm font-medium text-gray-900",children:"Atrasadas"}),e.jsx(D,{className:"h-4 w-4 text-red-500"})]}),e.jsxs(z,{children:[e.jsx("div",{className:"text-2xl font-bold text-gray-900",children:i}),e.jsx("p",{className:"text-xs text-gray-600",children:"Atenção necessária"})]})]})]})},We=({searchTerm:m,statusFilter:n,typeFilter:d,onSearchChange:i,onStatusFilterChange:l,onTypeFilterChange:h})=>e.jsxs(_,{className:"border-l-4 border-l-indigo-500 shadow-sm",children:[e.jsx(O,{className:"bg-indigo-50",children:e.jsxs(B,{className:"flex items-center gap-2 text-gray-900",children:[e.jsx(Le,{className:"h-5 w-5 text-indigo-500"}),"Filtros"]})}),e.jsx(z,{children:e.jsxs("div",{className:"flex flex-col md:flex-row gap-4",children:[e.jsx("div",{className:"flex-1",children:e.jsxs("div",{className:"relative",children:[e.jsx(_e,{className:"absolute left-2 top-2.5 h-4 w-4 text-muted-foreground"}),e.jsx(L,{placeholder:"Buscar por título, pessoa ou descrição...",value:m,onChange:N=>i(N.target.value),className:"pl-8"})]})}),e.jsxs(T,{value:n,onValueChange:l,children:[e.jsx(S,{className:"w-[180px]",children:e.jsx(C,{placeholder:"Status"})}),e.jsxs(I,{children:[e.jsx(t,{value:"todas",children:"Todos os Status"}),e.jsx(t,{value:"pendente",children:"Pendente"}),e.jsx(t,{value:"em_andamento",children:"Em Andamento"}),e.jsx(t,{value:"concluido",children:"Concluído"}),e.jsx(t,{value:"cancelado",children:"Cancelado"})]})]}),e.jsxs(T,{value:d,onValueChange:h,children:[e.jsx(S,{className:"w-[180px]",children:e.jsx(C,{placeholder:"Tipo"})}),e.jsxs(I,{children:[e.jsx(t,{value:"todos",children:"Todos os Tipos"}),e.jsx(t,{value:"atendimento",children:"Atendimento"}),e.jsx(t,{value:"ligacao",children:"Ligação"}),e.jsx(t,{value:"email",children:"E-mail"}),e.jsx(t,{value:"whatsapp",children:"WhatsApp"}),e.jsx(t,{value:"reuniao",children:"Reunião"}),e.jsx(t,{value:"visita",children:"Visita"}),e.jsx(t,{value:"evento",children:"Evento"}),e.jsx(t,{value:"outro",children:"Outro"})]})]})]})})]}),Ge=({interactions:m,people:n,onViewDetails:d,onEdit:i,onDelete:l})=>{const h=r=>{switch(r){case"concluido":return e.jsx(E,{className:"h-4 w-4 text-green-500"});case"em_progresso":return e.jsx(j,{className:"h-4 w-4 text-orange-500"});case"em_andamento":return e.jsx(j,{className:"h-4 w-4 text-blue-500"});case"pendente":return e.jsx(D,{className:"h-4 w-4 text-yellow-500"});case"cancelado":return e.jsx(Y,{className:"h-4 w-4 text-red-500"});default:return e.jsx(D,{className:"h-4 w-4 text-gray-500"})}},N=r=>{const y={concluido:"default",em_progresso:"secondary",em_andamento:"secondary",pendente:"outline",cancelado:"destructive"},g={concluido:"Concluído",em_progresso:"Em Progresso",em_andamento:"Em Andamento",pendente:"Pendente",cancelado:"Cancelado"};return e.jsx(le,{variant:y[r],children:g[r]})},o=r=>{switch(r){case"atendimento":return e.jsx(Q,{className:"h-4 w-4"});case"ligacao":return e.jsx(Ue,{className:"h-4 w-4"});case"email":return e.jsx(ke,{className:"h-4 w-4"});case"whatsapp":return e.jsx(U,{className:"h-4 w-4"});case"reuniao":return e.jsx(oe,{className:"h-4 w-4"});case"visita":return e.jsx(W,{className:"h-4 w-4"});default:return e.jsx(M,{className:"h-4 w-4"})}},a=r=>{const y=n.find(g=>g.id===r);return y?y.name:"Pessoa não encontrada"};return e.jsxs(_,{className:"border-l-4 border-l-emerald-500 shadow-sm",children:[e.jsx(O,{className:"bg-emerald-50",children:e.jsxs(B,{className:"flex items-center gap-2 text-gray-900",children:[e.jsx(U,{className:"h-5 w-5 text-emerald-500"}),"Interações (",m.length,")"]})}),e.jsxs(z,{children:[e.jsxs(Se,{children:[e.jsx(Ce,{children:e.jsxs(se,{children:[e.jsx(A,{children:"Tipo"}),e.jsx(A,{children:"Título"}),e.jsx(A,{children:"Pessoa"}),e.jsx(A,{children:"Status"}),e.jsx(A,{children:"Data Agendada"}),e.jsx(A,{children:"Criado em"}),e.jsx(A,{className:"text-right",children:"Ações"})]})}),e.jsx(Ie,{children:m.map(r=>e.jsxs(se,{children:[e.jsx(P,{children:e.jsxs("div",{className:"flex items-center gap-2",children:[o(r.type),e.jsx("span",{className:"capitalize",children:r.type})]})}),e.jsx(P,{className:"font-medium",children:r.title}),e.jsx(P,{children:a(r.personId)}),e.jsx(P,{children:e.jsxs("div",{className:"flex items-center gap-2",children:[h(r.status),N(r.status)]})}),e.jsx(P,{children:r.scheduledDate?Ee(r.scheduledDate):"-"}),e.jsx(P,{children:Ae(r.createdAt)}),e.jsx(P,{className:"text-right",children:e.jsxs("div",{className:"flex items-center justify-end gap-2",children:[e.jsx(k,{variant:"ghost",size:"sm",onClick:()=>d(r),children:e.jsx(Oe,{className:"h-4 w-4"})}),i&&e.jsx(k,{variant:"ghost",size:"sm",onClick:()=>i(r),children:e.jsx(Be,{className:"h-4 w-4"})}),l&&e.jsx(k,{variant:"ghost",size:"sm",onClick:()=>l(r),children:e.jsx(ze,{className:"h-4 w-4"})})]})})]},r.id))})]}),m.length===0&&e.jsx("div",{className:"text-center py-8",children:e.jsx("p",{className:"text-muted-foreground",children:"Nenhuma interação encontrada"})})]})]})},te=({isOpen:m,isEditMode:n,formData:d,people:i,onClose:l,onSubmit:h,onFormDataChange:N})=>{const o=(a,r)=>{N({[a]:r})};return e.jsx(re,{open:m,onOpenChange:l,children:e.jsxs(ne,{className:"max-w-3xl max-h-[90vh] overflow-y-auto",children:[e.jsx(ce,{className:"space-y-3 pb-6 border-b",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-blue-100 rounded-lg",children:e.jsx(U,{className:"h-6 w-6 text-blue-600"})}),e.jsxs("div",{children:[e.jsx(de,{className:"text-xl font-semibold text-gray-900",children:n?"Editar Interação":"Nova Interação"}),e.jsx(ie,{className:"text-gray-600 mt-1",children:n?"Atualize as informações da interação":"Registre um novo atendimento ou acompanhamento"})]})]})}),e.jsxs("div",{className:"grid gap-6 py-6",children:[e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Q,{className:"h-4 w-4 text-gray-600"}),e.jsx(p,{className:"font-medium text-gray-700",children:"Vincular Pessoa *"})]}),e.jsxs("div",{className:"relative",children:[e.jsxs(T,{value:d.personId,onValueChange:a=>o("personId",a),children:[e.jsx(S,{className:"pl-10",children:e.jsx(C,{placeholder:"Selecione uma pessoa"})}),e.jsx(I,{children:i.map(a=>e.jsx(t,{value:a.id,children:a.name},a.id))})]}),e.jsx(oe,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(U,{className:"h-4 w-4 text-gray-600"}),e.jsx(p,{htmlFor:"type",className:"font-medium text-gray-700",children:"Tipo *"})]}),e.jsxs("div",{className:"relative",children:[e.jsxs(T,{value:d.type,onValueChange:a=>o("type",a),children:[e.jsx(S,{className:"pl-10",children:e.jsx(C,{placeholder:"Tipo de interação"})}),e.jsxs(I,{children:[e.jsx(t,{value:"atendimento",children:"📋 Atendimento"}),e.jsx(t,{value:"ligacao",children:"📞 Ligação"}),e.jsx(t,{value:"email",children:"📧 E-mail"}),e.jsx(t,{value:"whatsapp",children:"💬 WhatsApp"}),e.jsx(t,{value:"reuniao",children:"🤝 Reunião"}),e.jsx(t,{value:"visita",children:"🏠 Visita"}),e.jsx(t,{value:"evento",children:"🎉 Evento"}),e.jsx(t,{value:"outro",children:"📝 Outro"})]})]}),e.jsx(U,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"})]})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(V,{className:"h-4 w-4 text-gray-600"}),e.jsx(p,{htmlFor:"title",className:"font-medium text-gray-700",children:"Título *"})]}),e.jsxs("div",{className:"relative",children:[e.jsx(L,{id:"title",placeholder:"Título da interação",value:d.title,onChange:a=>o("title",a.target.value),className:"pl-10"}),e.jsx(V,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(V,{className:"h-4 w-4 text-gray-600"}),e.jsx(p,{htmlFor:"description",className:"font-medium text-gray-700",children:"Descrição *"})]}),e.jsxs("div",{className:"relative",children:[e.jsx("textarea",{id:"description",className:"flex min-h-[100px] w-full rounded-md border border-input bg-background pl-10 pr-3 py-3 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 resize-none",placeholder:"Descreva detalhadamente a interação...",value:d.description,onChange:a=>o("description",a.target.value)}),e.jsx(V,{className:"absolute left-3 top-3 h-4 w-4 text-gray-400"})]})]}),d.type==="evento"&&e.jsxs("div",{className:"space-y-4 p-6 border-2 border-dashed border-green-200 rounded-xl bg-green-50",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(W,{className:"h-5 w-5 text-green-600"}),e.jsx("h4",{className:"font-semibold text-green-800",children:"Informações do Evento"})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(W,{className:"h-4 w-4 text-gray-600"}),e.jsx(p,{htmlFor:"eventLocation",className:"font-medium text-gray-700",children:"Local *"})]}),e.jsxs("div",{className:"relative",children:[e.jsxs(T,{value:d.eventLocation||"",onValueChange:a=>o("eventLocation",a),children:[e.jsx(S,{className:"pl-10",children:e.jsx(C,{placeholder:"Selecione o local"})}),e.jsxs(I,{children:[e.jsx(t,{value:"plenario",children:"🏛️ Plenário"}),e.jsx(t,{value:"plenarinho",children:"🏢 Plenarinho"}),e.jsx(t,{value:"presidencia",children:"🏛️ Presidência"}),e.jsx(t,{value:"estacionamento_interno",children:"🚗 Estacionamento Interno"}),e.jsx(t,{value:"estacionamento_externo",children:"🅿️ Estacionamento Externo"}),e.jsx(t,{value:"outros",children:"📍 Outros"})]})]}),e.jsx(W,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(j,{className:"h-4 w-4 text-gray-600"}),e.jsx(p,{htmlFor:"eventStartTime",className:"font-medium text-gray-700",children:"Horário de Início *"})]}),e.jsxs("div",{className:"relative",children:[e.jsx(L,{id:"eventStartTime",type:"time",value:d.eventStartTime||"",onChange:a=>o("eventStartTime",a.target.value),className:"pl-10"}),e.jsx(j,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(j,{className:"h-4 w-4 text-gray-600"}),e.jsx(p,{htmlFor:"eventEndTime",className:"font-medium text-gray-700",children:"Horário de Fim *"})]}),e.jsxs("div",{className:"relative",children:[e.jsx(L,{id:"eventEndTime",type:"time",value:d.eventEndTime||"",onChange:a=>o("eventEndTime",a.target.value),className:"pl-10"}),e.jsx(j,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ae,{className:"h-4 w-4 text-gray-600"}),e.jsx(p,{htmlFor:"eventScheduledBy",className:"font-medium text-gray-700",children:"Marcado por *"})]}),e.jsxs("div",{className:"relative",children:[e.jsxs(T,{value:d.eventScheduledBy||"",onValueChange:a=>o("eventScheduledBy",a),children:[e.jsx(S,{className:"pl-10",children:e.jsx(C,{placeholder:"Como foi marcado o evento?"})}),e.jsxs(I,{children:[e.jsx(t,{value:"email",children:"📧 E-mail"}),e.jsx(t,{value:"visita",children:"🏠 Visita"}),e.jsx(t,{value:"reuniao",children:"🤝 Reunião"}),e.jsx(t,{value:"whatsapp",children:"💬 WhatsApp"}),e.jsx(t,{value:"ligacao",children:"📞 Ligação"}),e.jsx(t,{value:"outros",children:"📝 Outros"})]})]}),e.jsx(ae,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(E,{className:"h-4 w-4 text-gray-600"}),e.jsx(p,{htmlFor:"status",className:"font-medium text-gray-700",children:"Status"})]}),e.jsxs("div",{className:"relative",children:[e.jsxs(T,{value:d.status,onValueChange:a=>o("status",a),children:[e.jsx(S,{className:"pl-10",children:e.jsx(C,{placeholder:"Status"})}),e.jsxs(I,{children:[e.jsx(t,{value:"pendente",children:"⏳ Pendente"}),e.jsx(t,{value:"em_progresso",children:"🔄 Em Progresso"}),e.jsx(t,{value:"em_andamento",children:"⚡ Em Andamento"}),e.jsx(t,{value:"concluido",children:"✅ Concluído"}),e.jsx(t,{value:"cancelado",children:"❌ Cancelado"})]})]}),e.jsx(E,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"})]})]}),!n&&e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(D,{className:"h-4 w-4 text-gray-600"}),e.jsx(p,{htmlFor:"priority",className:"font-medium text-gray-700",children:"Prioridade"})]}),e.jsxs("div",{className:"relative",children:[e.jsxs(T,{value:d.priority,onValueChange:a=>o("priority",a),children:[e.jsx(S,{className:"pl-10",children:e.jsx(C,{placeholder:"Prioridade"})}),e.jsxs(I,{children:[e.jsx(t,{value:"baixa",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(E,{className:"h-4 w-4 text-green-500"}),"Baixa"]})}),e.jsx(t,{value:"normal",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ve,{className:"h-4 w-4 text-blue-500"}),"Normal"]})}),e.jsx(t,{value:"media",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(D,{className:"h-4 w-4 text-yellow-500"}),"Média"]})}),e.jsx(t,{value:"alta",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(D,{className:"h-4 w-4 text-red-500"}),"Alta"]})})]})]}),e.jsx(D,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(M,{className:"h-4 w-4 text-gray-600"}),e.jsx(p,{htmlFor:"scheduledDate",className:"font-medium text-gray-700",children:"Data Agendada"})]}),e.jsxs("div",{className:"relative",children:[e.jsx(L,{id:"scheduledDate",type:"datetime-local",value:d.scheduledDate||"",onChange:a=>o("scheduledDate",a.target.value),className:"pl-10"}),e.jsx(M,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"})]})]}),!n&&e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(j,{className:"h-4 w-4 text-gray-600"}),e.jsx(p,{htmlFor:"followUpDate",className:"font-medium text-gray-700",children:"Data de Follow-up"})]}),e.jsxs("div",{className:"relative",children:[e.jsx(L,{id:"followUpDate",type:"date",value:d.followUpDate||"",onChange:a=>o("followUpDate",a.target.value),className:"pl-10"}),e.jsx(j,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"})]})]})]})]}),e.jsx(Pe,{className:"pt-6 border-t bg-gray-50 rounded-b-lg -mx-6 -mb-6 px-6 pb-6",children:e.jsxs("div",{className:"flex gap-3 w-full justify-end",children:[e.jsxs(k,{variant:"outline",onClick:l,className:"px-6 py-2 font-medium",children:[e.jsx(Y,{className:"h-4 w-4 mr-2"}),"Cancelar"]}),e.jsxs(k,{onClick:h,className:"px-6 py-2 font-medium bg-blue-600 hover:bg-blue-700",children:[e.jsx(E,{className:"h-4 w-4 mr-2"}),n?"Atualizar Interação":"Salvar Interação"]})]})})]})})},$e=({isOpen:m,interaction:n,people:d,onClose:i})=>{if(!n)return null;const l=d.find(a=>a.id===n.personId),h=a=>{switch(a){case"pendente":return e.jsx(D,{className:"h-4 w-4 text-yellow-500"});case"em_progresso":return e.jsx(j,{className:"h-4 w-4 text-orange-500"});case"em_andamento":return e.jsx(Me,{className:"h-4 w-4 text-blue-500"});case"concluido":return e.jsx(E,{className:"h-4 w-4 text-green-500"});case"cancelado":return e.jsx(Y,{className:"h-4 w-4 text-red-500"});default:return e.jsx(D,{className:"h-4 w-4 text-gray-500"})}},N=a=>{const r={pendente:"secondary",em_progresso:"default",em_andamento:"default",concluido:"default",cancelado:"destructive"},y={pendente:"Pendente",em_progresso:"Em Progresso",em_andamento:"Em Andamento",concluido:"Concluído",cancelado:"Cancelado"};return e.jsxs(le,{variant:r[a],className:"flex items-center gap-1",children:[h(a),y[a]]})},o=a=>new Date(a).toLocaleString("pt-BR",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"});return e.jsx(re,{open:m,onOpenChange:i,children:e.jsxs(ne,{className:"max-w-2xl",children:[e.jsxs(ce,{children:[e.jsxs(de,{className:"flex items-center gap-2",children:[e.jsx(V,{className:"h-5 w-5"}),"Detalhes da Interação"]}),e.jsx(ie,{children:"Informações completas sobre a interação"})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm font-medium text-gray-600",children:[e.jsx(Q,{className:"h-4 w-4"}),"Pessoa"]}),e.jsx("p",{className:"text-sm",children:l?.name||"Pessoa não encontrada"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"flex items-center gap-2 text-sm font-medium text-gray-600",children:"Status"}),e.jsx("div",{children:N(n.status)})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"text-sm font-medium text-gray-600",children:"Tipo"}),e.jsx("p",{className:"text-sm capitalize",children:n.type})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"text-sm font-medium text-gray-600",children:"Título"}),e.jsx("p",{className:"text-sm font-medium",children:n.title})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"text-sm font-medium text-gray-600",children:"Descrição"}),e.jsx("div",{className:"bg-gray-50 p-3 rounded-md",children:e.jsx("p",{className:"text-sm whitespace-pre-wrap",children:n.description})})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.scheduledDate&&e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm font-medium text-gray-600",children:[e.jsx(M,{className:"h-4 w-4"}),"Data Agendada"]}),e.jsx("p",{className:"text-sm",children:o(n.scheduledDate?.toISOString()||"")})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm font-medium text-gray-600",children:[e.jsx(j,{className:"h-4 w-4"}),"Criado em"]}),e.jsx("p",{className:"text-sm",children:o(n.createdAt.toISOString())})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm font-medium text-gray-600",children:[e.jsx(j,{className:"h-4 w-4"}),"Atualizado em"]}),e.jsx("p",{className:"text-sm",children:o(n.updatedAt.toISOString())})]}),n.completedDate&&e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm font-medium text-gray-600",children:[e.jsx(E,{className:"h-4 w-4"}),"Concluído em"]}),e.jsx("p",{className:"text-sm",children:o(n.completedDate.toISOString())})]})]})]})]})})},ss=()=>{const{canCreate:m,canEdit:n,canDelete:d}=Fe(),[i,l]=u.useState([]),[h,N]=u.useState([]),[o,a]=u.useState(!0),[r,y]=u.useState(""),[g,F]=u.useState("todas"),[f,G]=u.useState("todos"),[H,$]=u.useState(null),[me,J]=u.useState(!1),[xe,X]=u.useState(!1),[he,Z]=u.useState(!1),[c,R]=u.useState({personId:"",type:"atendimento",title:"",description:"",status:"pendente",priority:"normal",eventLocation:"",eventStartTime:"",eventEndTime:"",eventScheduledBy:""});Re({interactions:i,onUpdateInteraction:s=>{l(x=>x.map(v=>v.id===s.id?s:v)),b.success(`Status da interação "${s.title}" atualizado automaticamente para "${s.status}"`)}});const ue=[{id:"1",personId:"1",type:"atendimento",title:"Consulta sobre serviços de saúde",description:"Dúvidas sobre horários de funcionamento do posto de saúde",status:"concluido",scheduledDate:new Date("2024-01-15T10:00:00"),completedDate:new Date("2024-01-15T10:30:00"),responsibleUserId:"user1",createdAt:new Date("2024-01-14T14:00:00"),updatedAt:new Date("2024-01-15T10:30:00")},{id:"2",personId:"2",type:"reuniao",title:"Reunião sobre projeto de revitalização",description:"Discussão sobre o projeto de revitalização do centro da cidade",status:"em_andamento",scheduledDate:new Date("2024-01-17T14:00:00"),responsibleUserId:"user2",createdAt:new Date("2024-01-16T09:00:00"),updatedAt:new Date("2024-01-16T09:00:00")},{id:"3",personId:"3",type:"ligacao",title:"Solicitação de melhoria na iluminação pública",description:"Senhora Maria solicitou melhoria na iluminação da Rua das Flores",status:"pendente",scheduledDate:new Date("2024-01-21T09:00:00"),responsibleUserId:"user3",createdAt:new Date("2024-01-14T16:00:00"),updatedAt:new Date("2024-01-14T16:00:00")},{id:"4",personId:"1",type:"whatsapp",title:"Solicitação de informações sobre documentos",description:"Informações sobre documentos necessários para aposentadoria",status:"cancelado",responsibleUserId:"user1",createdAt:new Date("2024-01-10T11:00:00"),updatedAt:new Date("2024-01-12T15:00:00")}],pe=[{id:"1",name:"Pedro Estevão",birthDate:new Date("1980-05-15"),email:"pedro@email.com",phone:"(11) 99999-9999",relationshipType:"eleitor",createdAt:new Date,updatedAt:new Date,createdBy:"user1",updatedBy:"user1"},{id:"2",name:"Maria Assunção",birthDate:new Date("1975-08-22"),email:"maria@email.com",phone:"(11) 88888-8888",relationshipType:"parceiro",createdAt:new Date,updatedAt:new Date,createdBy:"user1",updatedBy:"user1"},{id:"3",name:"João Assessor",birthDate:new Date("1990-12-10"),email:"joao@email.com",phone:"(11) 77777-7777",relationshipType:"colaborador_assessor",createdAt:new Date,updatedAt:new Date,createdBy:"user1",updatedBy:"user1"}];u.useEffect(()=>{je(),ge()},[]);const je=async()=>{try{a(!0),await new Promise(s=>setTimeout(s,1e3)),l(ue)}catch(s){console.error("Erro ao carregar interações:",s),b.error("Não foi possível carregar as interações")}finally{a(!1)}},ge=async()=>{try{N(pe)}catch(s){console.error("Erro ao carregar pessoas:",s)}},ve=async()=>{try{if(!c.personId){b.error("Selecione uma pessoa");return}const s={id:Date.now().toString(),personId:c.personId,type:c.type,title:c.title,description:c.description,status:c.status,priority:c.priority,scheduledDate:c.scheduledDate?new Date(c.scheduledDate):void 0,responsibleUserId:"current-user",createdAt:new Date,updatedAt:new Date,eventLocation:c.type==="evento"?c.eventLocation:void 0,eventStartTime:c.type==="evento"?c.eventStartTime:void 0,eventEndTime:c.type==="evento"?c.eventEndTime:void 0};l(x=>[s,...x]),J(!1),ee(),b.success("Interação criada com sucesso")}catch(s){console.error("Erro ao criar interação:",s),b.error("Não foi possível criar a interação")}},Ne=async()=>{if(H)try{const s={...H,type:c.type,title:c.title,description:c.description,status:c.status,priority:c.priority,scheduledDate:c.scheduledDate?new Date(c.scheduledDate):void 0,updatedAt:new Date,eventLocation:c.type==="evento"?c.eventLocation:void 0,eventStartTime:c.type==="evento"?c.eventStartTime:void 0,eventEndTime:c.type==="evento"?c.eventEndTime:void 0};l(x=>x.map(v=>v.id===H.id?s:v)),X(!1),$(null),ee(),b.success("Interação atualizada com sucesso")}catch(s){console.error("Erro ao atualizar interação:",s),b.error("Não foi possível atualizar a interação")}},ye=async s=>{if(window.confirm("Tem certeza que deseja excluir esta interação?"))try{l(x=>x.filter(v=>v.id!==s.id)),b.success("Interação excluída com sucesso")}catch(x){console.error("Erro ao excluir interação:",x),b.error("Não foi possível excluir a interação")}},ee=()=>{R({personId:"",type:"atendimento",title:"",description:"",status:"pendente",priority:"normal",eventLocation:"",eventStartTime:"",eventEndTime:""})},fe=s=>{$(s),R({personId:s.personId,type:s.type,title:s.title,description:s.description,status:s.status,scheduledDate:s.scheduledDate?s.scheduledDate.toISOString().slice(0,16):"",priority:s.priority||"normal",eventLocation:s.eventLocation||"",eventStartTime:s.eventStartTime||"",eventEndTime:s.eventEndTime||""}),X(!0)},we=s=>{$(s),Z(!0)},be=i.filter(s=>{const x=h.find(Te=>Te.id===s.personId),v=x?x.name:"Pessoa não encontrada",K=s.title.toLowerCase().includes(r.toLowerCase())||s.description.toLowerCase().includes(r.toLowerCase())||v.toLowerCase().includes(r.toLowerCase()),w=g==="todas"||s.status===g,De=f==="todos"||s.type===f;return K&&w&&De}),q=(()=>{const s=i.length,x=i.filter(w=>w.status==="pendente").length,v=i.filter(w=>w.status==="concluido").length,K=i.filter(w=>w.status==="pendente"&&w.scheduledDate&&w.scheduledDate<new Date).length;return{total:s,pendentes:x,concluidas:v,atrasadas:K}})();return o?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary mx-auto mb-4"}),e.jsx("p",{className:"text-muted-foreground",children:"Carregando interações..."})]})}):e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"bg-gradient-to-r from-blue-50 to-indigo-50 rounded-lg p-6 border border-l-4 border-l-blue-500",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"bg-blue-500 rounded-full p-3",children:e.jsx(U,{className:"h-6 w-6 text-white"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Gerenciar Interações"}),e.jsx("p",{className:"text-gray-600",children:"Acompanhe todos os atendimentos e follow-ups"})]})]}),m()&&e.jsxs(k,{onClick:()=>J(!0),children:[e.jsx(He,{className:"mr-2 h-4 w-4"}),"Nova Interação"]})]})}),e.jsx(qe,{total:q.total,pendentes:q.pendentes,concluidas:q.concluidas,atrasadas:q.atrasadas}),e.jsx(We,{searchTerm:r,onSearchChange:y,statusFilter:g,onStatusFilterChange:F,typeFilter:f,onTypeFilterChange:G}),e.jsx(Ge,{interactions:be,people:h,onViewDetails:we,onEdit:n()?fe:void 0,onDelete:d()?ye:void 0}),e.jsx(te,{isOpen:me,isEditMode:!1,formData:c,people:h,onClose:()=>J(!1),onSubmit:ve,onFormDataChange:s=>R(x=>({...x,...s}))}),e.jsx(te,{isOpen:xe,isEditMode:!0,formData:c,people:h,onClose:()=>X(!1),onSubmit:Ne,onFormDataChange:s=>R(x=>({...x,...s}))}),e.jsx($e,{isOpen:he,interaction:H,people:h,onClose:()=>Z(!1)})]})};export{ss as default};
